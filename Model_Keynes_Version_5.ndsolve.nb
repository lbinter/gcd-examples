Notebook[{
Cell[
RowBox[{RowBox[{ClearAll,"[","\"\<Global`*\>\"","]"}]}], "Input"],
Cell[
BoxData[
RowBox[{RowBox[List[RowBox[List["SetOptions", "[", RowBox[List["Plot", ",", RowBox[List["ImageSize", "\[Rule]", "350"]]]], "]"]], ";"]], "\[IndentingNewLine]"
}]], "Input"],
Cell[
BoxData[
RowBox[{RowBox[{RowBox[{"defaultColor","=",Automatic,";"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"defaultThickness","=",RowBox[{AbsoluteThickness,"[",1,"]"}],";"}]}],"\[IndentingNewLine]"
,RowBox[{"PLOTSTYLEKeynesversusNeoklassik",":=",RowBox[{"{",RowBox[{"\[IndentingNewLine]"
,RowBox[{"Directive","[",RowBox[{"Blue",",","AbsoluteThickness[2.0]",",","Full"}],"]"}],",",RowBox[{"(*",RowBox[{"Agent"," ","F"}],"*)"}],"\[IndentingNewLine]"
,RowBox[{"Directive","[",RowBox[{"Green",",","AbsoluteThickness[2.0]",",","Full"}],"]"}],",",RowBox[{"(*",RowBox[{"Agent"," ","H"}],"*)"}],"\[IndentingNewLine]"
,RowBox[{"Directive","[",RowBox[{"Red",",","AbsoluteThickness[4.0]"}],"]"}],",",RowBox[{"(*",RowBox[{"inv"}],"*)"}],"\[IndentingNewLine]"
,RowBox[{"Directive","[",RowBox[{"Green",",","AbsoluteThickness[2.0]"}],"]"}],RowBox[{"(*",RowBox[{"spar"}],"*)"}],"\[IndentingNewLine]"
}],"}"}],";"}],"\[IndentingNewLine]"
}]], "Input"],
Cell[
BoxData[
RowBox[{RowBox[{RowBox[{"(*",RowBox[{"durch"," ","Differentialgleichungen"," ","bestimmte"," ","Variable"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"diffvar","=",RowBox[{"{",RowBox[{inv,",",spar}],"}"}]}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"ndiffvar","=",RowBox[{Length,"[","diffvar","]"}]}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"durch"," ","algebraische"," ","Definitionsgleichungen"," ","bestimmte"," ","Variable"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"algvar","=",RowBox[{"{",RowBox[{}],"}"}]}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"nalgvar","=",RowBox[{Length,"[","algvar","]"}]}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"gesamte"," ","Variable"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"var","=",RowBox[{Join,"[","diffvar",",","algvar","]"}]}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"nvar","=",RowBox[{Length,"[","var","]"}]}]}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"Agenten"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"AG","=",RowBox[{"{",RowBox[{agentF,",",agentH}],"}"}]}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"nAG","=",RowBox[{Length,"[","AG","]"}]}]}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"algebraische"," ","Definitionsgleichungen"," ","der"," ","\"algebraischen\""," ","Variablen"," ","algvar"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{RowBox[{"substitute","=",RowBox[{"{",RowBox[{}],"}"}],";"}]}]}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"Definitionsgleichungen"," ","der"," ","Nutzenfunktionen"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{RowBox[{"defuvar","[",RowBox[{"j_",",","t_",",","var_"}],"]"}],":=",RowBox[{RowBox[{"(",RowBox[List[RowBox[List["-", FractionBox["1", "2"]]], " ", SuperscriptBox[RowBox[List["(", RowBox[List["idach", "-", RowBox[List["inv", "[", "t", "]"]]]], ")"]], "2"]]],")"}],"/;",RowBox[{j,"==",agentF}]}],";"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{RowBox[{"defuvar","[",RowBox[{"j_",",","t_",",","var_"}],"]"}],":=",RowBox[{RowBox[{"(",RowBox[List[RowBox[List["-", FractionBox["1", "2"]]], " ", SuperscriptBox[RowBox[List["(", RowBox[List["sdach", "-", RowBox[List["spar", "[", "t", "]"]]]], ")"]], "2"]]],")"}],"/;",RowBox[{j,"==",agentH}]}],";"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{RowBox[{"defuvarsubstitute","[",RowBox[{"j_",",","t_",",","var_"}],"]"}],":=",RowBox[{RowBox[{"(",RowBox[{RowBox[{"defuvar","[",RowBox[{"agentF",",","t",",","var"}],"]"}],"/.","substitute"}],")"}],"/;",RowBox[{j,"==",agentF}]}],";"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{RowBox[{"defuvarsubstitute","[",RowBox[{"j_",",","t_",",","var_"}],"]"}],":=",RowBox[{RowBox[{"(",RowBox[{RowBox[{"defuvar","[",RowBox[{"agentH",",","t",",","var"}],"]"}],"/.","substitute"}],")"}],"/;",RowBox[{j,"==",agentH}]}],";"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"defuvar","[",RowBox[{"agentF",",","t",",","var"}],"]"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"defuvar","[",RowBox[{"agentH",",","t",",","var"}],"]"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"defuvarsubstitute","[",RowBox[{"agentF",",","t",",","var"}],"]"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"defuvarsubstitute","[",RowBox[{"agentH",",","t",",","var"}],"]"}]}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"Definitionsgleichungen"," ","der"," ","Zwangsbedingungen"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"nZwangB","=",1}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"inv[t]-spar[t]"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{RowBox[{"defzvar","[",RowBox[{"q_",",","t_",",","var_"}],"]"}],":=",RowBox[{RowBox[{"(",RowBox[List[RowBox[List["inv", "[", "t", "]"]], "-", RowBox[List["spar", "[", "t", "]"]]]],")"}],"/;",RowBox[{q,"==",1}]}],";"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{RowBox[{"defzvarsubstitute","[",RowBox[{"q_",",","t_",",","var_"}],"]"}],":=",RowBox[{RowBox[{"(",RowBox[{RowBox[{"defzvar","[",RowBox[{"1",",","t",",","var"}],"]"}],"/.","substitute"}],")"}],"/;",RowBox[{q,"==",1}]}],";"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"defzvar","[",RowBox[{"1",",","t",",","var"}],"]"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"defzvarsubstitute","[",RowBox[{"1",",","t",",","var"}],"]"}]}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"indizierte"," ","Machtfaktoren"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"MFi","=",RowBox[{Table,"[",RowBox[{"\[Mu]","[",RowBox[{"j",",","i"}],"]"}],",",RowBox[{"{",RowBox[{j,",","AG"}],"}"}],",",RowBox[{"{",RowBox[{i,",","ndiffvar"}],"}"}],"]"}]}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"MFi","//",MatrixForm,";"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"Machtfaktoren"," ","m\[UDoubleDot]ssen"," ","in"," ","Manipulate"," ","als"," ","nichtindizierte"," ","Variable"," ","angegeben"," ","werden,"," ","indizierte"," ","Variable"," ","k\[ODoubleDot]nnen"," ","in"," ","Manipulate"," ","nicht"," ",""," ","manipuliert"," ","werden!!!"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"um"," ","change\[Mu]"," ","leichter"," ","hinschreiben"," ","zu"," ","k\[ODoubleDot]nnen,"," ","change\[Mu]"," ","kann"," ","leider"," ","nicht"," ","automatisch"," ","erstellt"," ","werden"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"flattenMFi","=",RowBox[{Flatten,"[","MFi","]"}],";"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"change\[Mu]","=",RowBox[{"{",RowBox[{"\[IndentingNewLine]"
,RowBox[{RowBox[{"\[Mu]","[",RowBox[{"agentF",",","1"}],"]"}],"\[Rule]","\[Mu]Finv"}],",",RowBox[{RowBox[{"\[Mu]","[",RowBox[{"agentF",",","2"}],"]"}],"\[Rule]","\[Mu]Fspar"}],",","\[IndentingNewLine]"
,"\[IndentingNewLine]"
,RowBox[{RowBox[{"\[Mu]","[",RowBox[{"agentH",",","1"}],"]"}],"\[Rule]","\[Mu]Hinv"}],",",RowBox[{RowBox[{"\[Mu]","[",RowBox[{"agentH",",","2"}],"]"}],"\[Rule]","\[Mu]Hspar"}],"\[IndentingNewLine]"
}],"}"}],";"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"Machtfaktoren"," ","als"," ","nicht"," ","indizierte"," ","Variable"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"MFex","=",RowBox[{"flattenMFi","/.","change\[Mu]"}]}]}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"Lagrangefaktoren"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"\[Lambda]F","=",RowBox[{Array,"[",RowBox[{SubscriptBox["\[Lambda]","#"],"&"}],",",RowBox[{"{",RowBox[{"nZwangB"}],"}"}],"]"}]}]}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"Wandle"," ","die"," ","aktuellen"," ","Variablen"," ","diffvar"," ","um"," ","in"," ","ein"," ","Array"," ","diffvarx"," ","von"," ","indizierten"," ","Variablen"," ","x"," ","der"," ","L\[ADoubleDot]nge"," ","ndiffvar"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"diffvarx","=",RowBox[{Array,"[",RowBox[{SubscriptBox["x","#"],"&"}],",",RowBox[{"{",RowBox[{"ndiffvar"}],"}"}],"]"}],";"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"algvarxx","=",RowBox[{Array,"[",RowBox[{SubscriptBox["xx","#"],"&"}],",",RowBox[{"{",RowBox[{"nalgvar"}],"}"}],"]"}],";"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"varxxx","=",RowBox[{Join,"[","diffvarx",",","algvarxx","]"}]}]}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,RowBox[{RowBox[{"changediffax","=",RowBox[{"{",RowBox[{"\[IndentingNewLine]"
,RowBox[{"inv","\[Rule]",SubscriptBox["x",1]}],",",RowBox[{"spar","\[Rule]",SubscriptBox["x",2]}],"\[IndentingNewLine]"
}],"}"}]}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"changediffxa","=",RowBox[{"{",RowBox[{"\[IndentingNewLine]"
,RowBox[{SubscriptBox["x",1],"\[Rule]","inv"}],",",RowBox[{SubscriptBox["x",2],"\[Rule]","spar"}],"\[IndentingNewLine]"
}],"}"}]}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"changealgbxx","=",RowBox[{"{",RowBox[{}],"}"}]}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"changealgxxb","=",RowBox[{"{",RowBox[{}],"}"}]}]}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,RowBox[{RowBox[{RowBox[{"defalgvarsubstitutexxx","[",RowBox[{"jj_",",","t_",",","varxxx_"}],"]"}],":=",RowBox[{RowBox[{RowBox[{"defalgvarsubstitute","[",RowBox[{"jj",",","t",",","var"}],"]"}],"/.","changediffax"}],"/.","changealgbxx"}],";"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{RowBox[{"defuvarsubstitutexxx","[",RowBox[{"j_",",","t_",",","varxxx_"}],"]"}],":=",RowBox[{RowBox[{RowBox[{"defuvarsubstitute","[",RowBox[{"j",",","t",",","var"}],"]"}],"/.","changediffax"}],"/.","changealgbxx"}],";"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{RowBox[{"defzvarsubstitutexxx","[",RowBox[{"q_",",","t_",",","varxxx_"}],"]"}],":=",RowBox[{RowBox[{RowBox[{"defzvarsubstitute","[",RowBox[{"q",",","t",",","var"}],"]"}],"/.","changediffax"}],"/.","changealgbxx"}],";"}]}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,RowBox[{RowBox[{"defuvarsubstitutexxx","[",RowBox[{"agentF",",","t",",","varxxx"}],"]"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"defuvarsubstitutexxx","[",RowBox[{"agentH",",","t",",","varxxx"}],"]"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"defzvarsubstitutexxx","[",RowBox[{"1",",","t",",","varxxx"}],"]"}]}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"Verhaltensgleichungen"," ","f\[UDoubleDot]r"," ","allgemeines"," ","GCD"," ","Modell"," ","mit"," ","indizierten"," ","Variablen"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"dgldiffxxx","=",RowBox[{Table,"[",RowBox[{RowBox[{RowBox[{SubscriptBox["x","i"],"'"}],"[",RowBox[{"t"}],"]"}],"==",RowBox[{RowBox[{Sum,"[",RowBox[{RowBox[{"\[Mu]","[",RowBox[{"j",",","i"}],"]"}],RowBox[{Evaluate,"[",RowBox[{SubscriptBox["\[PartialD]",RowBox[{SubscriptBox["x","i"],"[",RowBox[{"t"}],"]"}]],RowBox[{"defuvarsubstitutexxx","[",RowBox[{"j",",","t",",","varxxx"}],"]"}]}],"]"}]}],",",RowBox[{"{",RowBox[{j,",","AG"}],"}"}],"]"}],"+",RowBox[{Sum,"[",RowBox[{RowBox[{SubscriptBox["\[Lambda]",q],"[",RowBox[{"t"}],"]"}],RowBox[{"If","[",RowBox[{RowBox[{RowBox[{Evaluate,"[",RowBox[{SubscriptBox["\[PartialD]",RowBox[{RowBox[{SubscriptBox["x","i"],"'"}],"[",RowBox[{"t"}],"]"}]],RowBox[{"defzvarsubstitutexxx","[",RowBox[{"q",",","t",",","varxxx"}],"]"}]}],"]"}],"!=",0}],",","\[IndentingNewLine]"
,RowBox[{Evaluate,"[",RowBox[{SubscriptBox["\[PartialD]",RowBox[{RowBox[{SubscriptBox["x","i"],"'"}],"[",RowBox[{"t"}],"]"}]],RowBox[{"defzvarsubstitutexxx","[",RowBox[{"q",",","t",",","varxxx"}],"]"}]}],"]"}],",","\[IndentingNewLine]"
,RowBox[{Evaluate,"[",RowBox[{SubscriptBox["\[PartialD]",RowBox[{SubscriptBox["x","i"],"[",RowBox[{"t"}],"]"}]],RowBox[{"defzvarsubstitutexxx","[",RowBox[{"q",",","t",",","varxxx"}],"]"}]}],"]"}]}],"]"}]}],",",RowBox[{"{",RowBox[{q,",","nZwangB"}],"}"}],"]"}]}]}],",",RowBox[{"{",RowBox[{"i",",","ndiffvar"}],"}"}],"]"}],";"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"dglalgxxx","=",RowBox[{Table,"[",RowBox[{RowBox[{SubscriptBox["xx","ii"],"[",RowBox[{"t"}],"]"}],"==",RowBox[{"defalgvarsubstitutexxx","[",RowBox[{"ii",",","t",",","varxxx"}],"]"}]}],",",RowBox[{"{",RowBox[{ii,",","nalgvar"}],"}"}],"]"}],";"}]}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"Zwangsbedingungen"," ","f\[UDoubleDot]r"," ","allgemeines"," ","GCD"," ","Modell"," ","mit"," ","indizierten"," ","Variablen"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"dglzxxx","=",RowBox[{Table,"[",RowBox[{0,"==",RowBox[{"defzvarsubstitutexxx","[",RowBox[{"q",",","t",",","varxxx"}],"]"}]}],",",RowBox[{"{",RowBox[{q,",","nZwangB"}],"}"}],"]"}],";"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"dglxxx","=",RowBox[{Join,"[","dglalgxxx",",","dgldiffxxx",",","dglzxxx","]"}],";"}]}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"R\[UDoubleDot]cktransformation"," ","des"," ","Modells"," ","mit"," ","indizierten"," ","Variablen"," ","in"," ","Modell"," ","mit"," ","benannten"," ","Variablen"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"dgl","=",RowBox[{RowBox[{"dglxxx","/.","changediffxa"}],"/.","changealgxxb"}],";"}]}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"Definition"," ","der"," ","Anfangsbedingungen"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"init","=",RowBox[{"{",RowBox[{"\[IndentingNewLine]"
,RowBox[{RowBox[{"inv","[",RowBox[{"0"}],"]"}],"==","inv0"}],",",RowBox[{RowBox[{"spar","[",RowBox[{"0"}],"]"}],"==","inv0"}],"\[IndentingNewLine]"
}],"}"}],";"}]}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"Zum"," ","Berechnen"," ","und"," ","Plotten"," ","der"," ","Nutzenfunktionen"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"ugl","=",RowBox[{"{",RowBox[{"\[IndentingNewLine]"
,RowBox[{RowBox[{"uF","[",RowBox[{"t"}],"]"}],"==",RowBox[{"defuvar","[",RowBox[{"agentF",",","t",",","var"}],"]"}]}],",","\[IndentingNewLine]"
,RowBox[{RowBox[{"uH","[",RowBox[{"t"}],"]"}],"==",RowBox[{"defuvar","[",RowBox[{"agentH",",","t",",","var"}],"]"}]}],"\[IndentingNewLine]"
}],"}"}]}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"F\[UDoubleDot]hre"," ","alle"," ","Gleichungen"," ","f\[UDoubleDot]r"," ","NDSolve"," ","zusammen"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"gl","=",RowBox[{Join,"[","ugl",",","dgl",",","init","]"}],";"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"Differentialgleichungsvariable"," ","incl."," ","Lagrangefaktoren"," ","und"," ","Nutzenfunktionen"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"glvar","=",RowBox[{Join,"[",RowBox[{"{",RowBox[{"uF",",","uH"}],"}"}],",","var",",","\[Lambda]F","]"}]}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"Transformiere"," ","die"," ","indizierten"," ","Machtfaktoren"," ","in"," ","den"," ","Gleichungen"," ","gl"," ","in"," ","nicht"," ","indizierte"," ","Machtfaktoren"}],"*)"}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"GL","=",RowBox[{"gl","/.","change\[Mu]"}]}]}],"\[IndentingNewLine]"
,RowBox[{RowBox[{"(*",RowBox[{"Das"," ","berechnete"," ","Ergebnis"," ","von"," ","GL"," ","muss"," ","manuell"," ","in"," ","das"," ","Programm"," ","zur","\[IndentingNewLine]","L\[ODoubleDot]sung"," ","der"," ","Modellgleichungen"," ","\[UDoubleDot]bertragen"," ","werden"," ","(es"," ","reicht"," ","nicht"," ","indem","\[IndentingNewLine]","man"," ","nur"," ","\"GL\""," ","in"," ","NDSolve"," ","schreibt,"," ","das"," ","kann"," ","Manipulate"," ","nicht","\[IndentingNewLine]","verarbeiten)."," ","Dann"," ","das"," ","L\[ODoubleDot]sungsprogramm"," ","gesondert"," ","gestartet"," ","werden"}],"*)"}]}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
}]], "Input"],
Cell[
BoxData[
RowBox[{RowBox[{RowBox[{Manipulate,"[","\[IndentingNewLine]"
,RowBox[{Column,"[",RowBox[{"{",RowBox[{"\[IndentingNewLine]"
,RowBox[{Module,"[","\[IndentingNewLine]"
,RowBox[{"{",RowBox[{RowBox[{sol,"=",RowBox[{RowBox[{"Quiet","@","NDSolve"}],"[","%","\[IndentingNewLine]"
,",",RowBox[{"{",RowBox[{"uF",",","uH",",",inv,",",spar,",",SubscriptBox["\[Lambda]","1"]}],"}"}],"\[IndentingNewLine]"
,",",RowBox[{"{",RowBox[{t,",",0,",",50}],"}"}],",",RowBox[List["Method", "\[Rule]", "Automatic"]],"]"}]}]}],"}"}],",","\[IndentingNewLine]"
,RowBox[{"{",RowBox[{"\[IndentingNewLine]"
,RowBox[{"Plot","[",RowBox[{Evaluate,"[",RowBox[{RowBox[{"{",RowBox[{RowBox[List[RowBox[List["-", FractionBox["1", "2"]]], " ", SuperscriptBox[RowBox[List["(", RowBox[List["idach", "-", RowBox[List["inv", "[", "t", "]"]]]], ")"]], "2"]]],",",RowBox[List[RowBox[List["-", FractionBox["1", "2"]]], " ", SuperscriptBox[RowBox[List["(", RowBox[List["sdach", "-", RowBox[List["spar", "[", "t", "]"]]]], ")"]], "2"]]],",",RowBox[{"inv","[",RowBox[{"t"}],"]"}],",",RowBox[{"spar","[",RowBox[{"t"}],"]"}]}],"}"}],"/.","sol"}],"]"}],",","\[IndentingNewLine]"
,RowBox[List["{", RowBox[List["t", ",", "0", ",", "2"]], "}"]],",","\[IndentingNewLine]"
,RowBox[{"PlotRange","\[Rule]","5"}],",","\[IndentingNewLine]"
,RowBox[{"PlotStyle","\[Rule]","PLOTSTYLEKeynesversusNeoklassik"}],",","\[IndentingNewLine]"
,RowBox[{"PlotLabel","\[Rule]","\"Keynes versus Neoklassik\""}],",","\[IndentingNewLine]"
,RowBox[{"PlotLabels","\[Rule]",RowBox[{"{",RowBox[{"\"uF\"",",","\"uH\"",",","\"inv\"",",","\"spar\""}],"}"}]}],",","\[IndentingNewLine]"
,RowBox[{"PlotLegends","\[Rule]",RowBox[{"LineLegend","[",RowBox[{"{",RowBox[{"\"uF\"",",","\"uH\"",",","\"inv\"",",","\"spar\""}],"}"}],"]"}]}],"]"}],"\[IndentingNewLine]"
}],"}"}],"]"}],"\[IndentingNewLine]"
}],"}"}],"]"}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,",",RowBox[{"{",RowBox[{RowBox[{"{",RowBox[{inv0,",","0"}],"}"}],",","0",",","5"}],"}"}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,",",RowBox[{"{",RowBox[{RowBox[{"{",RowBox[{\[Mu]Finv,",","10"}],"}"}],",","0",",","10"}],"}"}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,",",RowBox[{"{",RowBox[{RowBox[{"{",RowBox[{\[Mu]Hspar,",","0"}],"}"}],",","0",",","10"}],"}"}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,",",RowBox[{"{",RowBox[{RowBox[{"{",RowBox[{idach,",","4"}],"}"}],",","0",",","5"}],"}"}],",",RowBox[{"{",RowBox[{RowBox[{"{",RowBox[{sdach,",","2"}],"}"}],",","0",",","5"}],"}"}],"\[IndentingNewLine]"
,"\[IndentingNewLine]"
,",",RowBox[{"{",RowBox[{RowBox[{"{",RowBox[{tmax,",",30}],"}"}],",",0,",",100}],"}"}],",",RowBox[{"{",RowBox[{RowBox[{"{",RowBox[{plotmax,",",2.5}],"}"}],",",0,",",20}],"}"}],"]"}]}],"\[IndentingNewLine]"
}]], "Input"]
}]